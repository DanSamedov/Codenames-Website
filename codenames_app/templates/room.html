{% extends 'base.html' %} {% load static %} {% block styles %}
<link rel="stylesheet" href="{% static 'css/dist/room.css' %}" />
{% endblock %} {% block content %}
<main class="flex-grow container mx-auto px-4 py-8 md:py-16">
  <div class="text-center mb-12">
    <h2 class="bebas-neue text-5xl md:text-6xl tracking-wider">
      <span class="text-[var(--primary-color)]">ASSEMBLE</span> YOUR
      <span class="text-[var(--secondary-color)]">SQUAD</span>
    </h2>
    <span class="text-xl text-[var(--text-light)]">Game {{ game_obj.id }}</span>
    <span class="mt-4 text-lg text-[var(--text-dark)]">
      - Join a team and select your role to begin the operation.
    </span>
  </div>
  <form
    method="POST"
    id="choose-team-form"
    class="grid md:grid-cols-2 gap-8 lg:gap-16"
  >
    {% csrf_token %} {{ choose_form.team }}
    <div class="team-container red-box-shadow flex flex-col">
      <h3 class="team-title text-[var(--primary-color)] mb-6">RED TEAM</h3>
      <ul class="player-list space-y-2 flex-grow" id="Red">
        {% for player in player_obj %} {% if player.team == "Red" %}
        <li class="player-item {{ player.username }}">
          <span class="player-name font-bold">{{ player.username }}</span>
          <div class="role-selector">
            <span class="text-[var(--text-light)] font-bold">
              {% if player.leader %} Spymaster {% else %} Operative {% endif %}
            </span>
          </div>
        </li>
        {% endif %} {% endfor %}
      </ul>
      <div class="mt-auto pt-4">
        <button type="button" class="join-team-btn join-red" data-team="Red">
          Join Red Team
        </button>
      </div>
    </div>
    <div class="team-container blue-box-shadow flex flex-col">
      <h3 class="team-title text-[var(--secondary-color)] mb-6">BLUE TEAM</h3>
      <ul class="player-list space-y-2 flex-grow" id="Blue">
        {% for player in player_obj %} {% if player.team == "Blue" %}
        <li class="player-item {{ player.username }}">
          <span class="player-name font-bold">{{ player.username }}</span>
          <div class="role-selector">
            <span class="text-[var(--text-light)] font-bold">
              {% if player.leader %} Spymaster {% else %} Operative {% endif %}
            </span>
          </div>
        </li>
        {% endif %} {% endfor %}
      </ul>
      <div class="mt-auto pt-4">
        <button type="button" class="join-team-btn join-blue" data-team="Blue">
          Join Blue Team
        </button>
      </div>
    </div>
    <template id="role-template">
      <div class="role-selector in-selection">{{ choose_form.role }}</div>
    </template>
  </form>
  {% if current_player.creator %}
  <div class="mt-16 flex justify-center">
    <form method="POST" id="start-game-form">
      {% csrf_token %}
      <button
        type="submit"
        id="start-game-btn"
        name="start_game"
        class="bebas-neue w-full md:w-auto px-12 py-4 text-2xl tracking-wider rounded bg-[var(--primary-color)] text-[var(--text-light)] hover:bg-red-700 transition-colors red-box-shadow"
      >
        Start the Game
      </button>
    </form>
  </div>
  {% endif %}
</main>
{% endblock %} {% block script %}
<script>
  window.roomConfig = {
    roomId: "{{ game_obj.id }}",
    currentUser: "{{ current_player.username }}",
    currentRole: "{{ current_player.leader }}",
    currentTeam: "{{ current_player.team }}",
    startingTeam: "{{ game_obj.starting_team }}",
  };
</script>
<script src="{% static 'js/room/websocketManager.js' %}"></script>
<script src="{% static 'js/room/messageHandler.js' %}"></script>
<script src="{% static 'js/room/formHandler.js' %}"></script>
<script src="{% static 'js/room/roomManager.js' %}"></script>
<script src="{% static 'js/room/main.js' %}"></script>
{% endblock %}
